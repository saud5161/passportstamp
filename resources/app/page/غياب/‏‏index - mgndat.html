<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>نموذج غياب</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            direction: rtl;
            text-align: right;
            margin: 20px;
            background-color: #f4f4f4;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            border: 1px solid #ccc;
            border-radius: 10px;
            background-color: #fff;
        }
        .section {
            margin-bottom: 20px;
            padding: 20px;
            border: 1px solid #ccc;
            border-radius: 10px;
            background-color: #f9f9f9;
        }
        .section h2 {
            margin-top: 0;
        }
        label {
            display: block;
            margin: 10px 0 5px;
        }
        input[type="text"],
        select {
            width: 100%;
            padding: 8px;
            margin-bottom: 10px;
            border: 1px solid #ccc;
            border-radius: 5px;
        }
        input[disabled],
        select[disabled] {
            background-color: #e9e9e9;
            cursor: not-allowed;
        }
        button {
            display: inline-block;
            width: calc(100% - 100px);
            padding: 10px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 5px;
            font-size: 16px;
            cursor: pointer;
        }
        button:disabled {
            background-color: #ddd;
            cursor: not-allowed;
        }
        button:hover:enabled {
            background-color: #45a049;
        }
        .error-message {
            color: red;
            text-align: center;
            display: none;
        }
        .editable {
            border: none;
            outline: none;
            background: none;
            resize: none;
        }
        .note {
            color: green;
            font-size: small;
        }
        .skip-container {
            display: flex;
            align-items: center;
            font-size: small;
        }
    </style>
</head>
<body>

<div class="container">
    <h1 class="editable" contenteditable="true">نموذج غياب</h1>

    <div class="section">
        <h2 class="editable" contenteditable="true">محضر غياب</h2>
        <label for="absenceType">نوع المحضر:</label>
        <select id="absenceType" name="absenceType" required>
            <option value="">اختر نوع المحضر</option>
            <option value="مجندات">مجندات</option>
            <option value="أفراد">أفراد</option>
        </select>
    </div>

    <div class="section">
        <h2 class="editable" contenteditable="true">معلومات التاريخ</h2>
        <span id="timeNote" class="note" style="display: none;">التاريخ وقت الاستلام</span>
        <label for="hijriDate">التاريخ (هجري):</label>
        <input type="text" id="hijriDate" name="hijriDate" required disabled>
        <label for="weekday">اليوم (أسبوعي):</label>
        <input type="text" id="weekday" name="weekday" required disabled>
    </div>

    <div class="section">
        <h2 class="editable" contenteditable="true">المناوبة والصالة</h2>
        <label for="department">المناوبة/ الشعبة:</label>
        <select id="department" name="department" required disabled>
            <option value="">اختر المناوبة</option>
            <option value="أ">أ</option>
            <option value="ب">ب</option>
            <option value="ج">ج</option>
            <option value="د">د</option>
        </select>
        <label for="room">رقم الصالة:</label>
        <select id="room" name="room" required disabled>
            <option value="">اختر رقم الصالة</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
        </select>
    </div>

    <div class="section">
        <h2 class="editable" contenteditable="true">معلومات الاسم والرتبة</h2>
        <label for="name">الاسم:</label>
        <input type="text" id="name" name="name" list="nameList" required disabled>
        <datalist id="nameList">
            <!-- ستتم إضافة الأسماء هنا بواسطة JavaScript -->
        </datalist>
        <label for="rank">الرتبة:</label>
        <select id="rank" name="rank" required disabled>
            <option value="">اختر الرتبة</option>
            <option value="جندي">جندي</option>
            <option value="جندي اول">جندي اول</option>
            <option value="عريف">عريف</option>
            <option value="وكيل رقيب">وكيل رقيب</option>
            <option value="رقيب">رقيب</option>
            <option value="رقيب اول">رقيب اول</option>
            <option value="رئيس رقباء">رئيس رقباء</option>
        </select>
    </div>

    <div class="section">
        <h2 class="editable" contenteditable="true">معلومات ضابط الصالة</h2>
        <label for="officerName">اسم ضابط الصالة:</label>
        <input type="text" id="officerName" name="officerName" required list="officerNameList" disabled>
        <datalist id="officerNameList">
            <option value="فيصل منصور السعيد">
            <option value="عبد الرحمن راشد البنية">
            <option value="معاذ ظفر ال دريس">
            <option value="عادل بنيدر المطيري">
            <option value="ماجد عبدالعزيز السحيم">
            <option value="فيصل عبد الاله الهرف">
            <option value="احمد علي العمري">
            <option value="الريان عبدالله الهويمل">
            <option value="تركي سعد المطيري">
            <option value="صالح ابراهيم السالم">
            <option value="عبدالله سعد المطيري">
            <option value="سعد عبدالعزيز الخشلان">
            <option value="حسن عايض القحطاني">
            <option value="جابر فتنان الحربي">
            <option value="عبدالعزيز سعيد القحطاني">
            <option value="عبدالله محمد البقمي">
            <option value="عبدالله عويض الحارثي">
            <option value="فايز سعيد الشهراني">
            <option value="رامي عوض الله السلمي">
            <option value="اسامه راشد المشوح">
            <option value="سامي عاشور الزهراني">
            <option value="مترك مهدي السبيعي">
            <option value="خالد عبدالله الحسين">
            <option value="سعود فراج السهلي">
            <option value="عبد الرحمن محمد العوشن">
            <option value="سعود محمد ال جبل">
            <option value="حمود علي الباهلي">
            <option value="فيصل موسى المطيري">
            <option value="فيصل سعد الضفيان">
            <option value="عبدالاله ضيف الله بن عميض">
            <option value="مالك احمد العنقري">
            <option value="عبدالله عوض المالكي">
            <option value="مهند فهد ال جلده">
            <option value="تركي عبدالله الزهراني">
            <option value="عبدالعزيز عبدالله الحارثي">
            <option value="عبدالعزيز عبدالله ال مطلق">
            <option value="صالح محمد الحميدان">
        </datalist>
        <label for="officerRank">رتبة ضابط الصالة:</label>
        <input type="text" id="officerRank" name="officerRank" required list="officerRankList" disabled>
        <datalist id="officerRankList">
            <option value="ملازم/">
            <option value="ملازم اول/">
            <option value="نقيب/">
            <option value="رائد/">
            <option value="مقدم/">
            <option value="عقيد/">
        </datalist>
        <label for="outgoingNumber">رقم الصادر:</label>
        <input type="text" id="outgoingNumber" name="outgoingNumber" required disabled>
    </div>

    <button type="button" id="submitButton" onclick="submitForm()">تنفيذ</button>
    <div class="skip-container">
        <input type="checkbox" id="skipValidation">
        <label for="skipValidation">تخطي</label>
    </div>
    <p class="error-message" id="errorMessage">الرجاء تعبئة جميع الخانات</p>
</div>

<script>
    document.addEventListener("DOMContentLoaded", function() {
        var today = new Date();
        var options = { year: 'numeric', month: '2-digit', day: '2-digit' };

        var hours = today.getHours();
        if (hours >= 0 && hours < 6) {
            today.setDate(today.getDate() - 1);
            document.getElementById("timeNote").style.display = "block";
        }

        var formattedDate = today.toLocaleDateString('ar-SA', options).replace(/\d+/g, function(d) {
            return ('0' + d).slice(-2);
        }).replace(/\/(\d{2})\//g, '/$1/');
        document.getElementById("hijriDate").value = toArabicNumbers(formattedDate);
        document.getElementById("weekday").value = today.toLocaleDateString('ar-SA', { weekday: 'long' });

        document.getElementById("department").addEventListener("change", function() {
            updateNames(this.value, document.getElementById("room").value);
        });

        document.getElementById("room").addEventListener("change", function() {
            updateNames(document.getElementById("department").value, this.value);
        });

        document.querySelectorAll('input, select').forEach(element => {
            element.addEventListener('input', validateForm);
        });

        document.getElementById("absenceType").addEventListener("change", function() {
            enableFields();
        });

        document.getElementById("skipValidation").addEventListener("change", function() {
            validateForm();
        });

        document.getElementById("name").addEventListener("change", function() {
            updateRank(this.value);
        });

        validateForm();
    });

    function toArabicNumbers(str) {
        return str.replace(/\d/g, d => '٠١٢٣٤٥٦٧٨٩'[d]);
    }

    function updateNames(department, room) {
        const nameList = document.getElementById("nameList");
        nameList.innerHTML = ''; // مسح الخيارات الحالية

        const namesA2 = [
            "أحمد مبارك ناصر الدوسري", "عمشاء خزيم السهلي", "باسم حمادي زولي", "سلطان سلامه العليمي",
            "شوق عائض القحطاني", "سعيد سعد سعيد ال طزاء", "سحر فايز آل قاعد", "يوسف محمد صالح العمري",
            "مسفر مجهار مسفر الدوسري", "مريم علي الزهراني", "هياء بركه العتيبي", "بندر إبراهيم محمد حبيبي",
            "هادي مناحي محمد الدوسري", "رنيم إبراهيم العواجي", "سعود علي حاضر الخثعمي", "مبارك محمد مبارك البليم",
            "محمد صقر العتيبي", "سالم مسفر فالح القحطاني", "العنود محمد العرفج", "مشاعل حسن الزهراني",
            "    محمد عبدالله سعد العمري  ", "مانع سالم الشهراني", "الهنوف محمد الشهراني", "سعد بشيت فهيد العنزي",
            "فهد محمد ناصر ال بريك"
        ];
        const namesB2 = [
            "عيسى خليف سعد الرشيدي", "محمد مطلق الشيباني", "زيد عبدالله زيد التميمي", "عبدالمجيد سلطان المغيري",
            "محمد محيميد الحربي", "بريك مبرك جود الله المطيري", "فهد مملوح الرشيدي", "هند حسن آل شقية",
            "رنا مسفر الوادعي", "عبير سلطان البقمي", "أسماء مطرد العنزي", "عبدالعزيز عواد مناور الحربي",
            "نوف عبدالعزيز الدوسري", "نجود صالح الصيعري", "الهنوف علي الأعجم", "هديل سلمان الشمري",
            "هاجر فهد العنزي", "مرام سعيد الشمراني", "سناء عبدالله القرني", "لبده فيحان بن لبده",
            "وفاء محمد الشهري", "رندا رابح الحربي", "نوف حمد الظهير", "هيثم عبدالله العثيم",
            "محمود فاطم المطيري"
        ];
        const namesC2 = [
            "فهد سعدي عبدالعزيز الشمري", "فواز طيب العتيبي", "سلطان هزاع غزاي الرويس", "عبدالرحمن الفالح شروق",
            "خديجة عبدالله الشهراني", "ايمان سلمان الشغرود", "ابرار محمد الهدهدي", "جمله نجاء المطيري",
            "ثامر منير قزعان العتيبي", "نواف عليان فنيس العتيبي", "خلود سند المطيري", "سلمى عيسى عسيري",
            "عواطف ذعار العتيبي", "نوف محمد المديني", "هتاف معيض المطيري", "نوف صياح العنزي",
            "عمر محمد علي الحجيلي", "رايد سويلم فهاد الشمري", "أنهار منصور الحمداني", "عبدالهادي مويسان العتيبي",
            "أحمد مهل سعد العتيبي", "شايع عبدالرحمن محمد العتيق", "عبدالعزيز مصلح آل عيد", "محمد طراد عبدالله الاسمري"
        ];
        const namesD2 = [
            "محمد حمد العتيبي", "محمد معتاد عبدالرحمن العتيبي", "إبراهيم عبدالله المباركي", "سعود فهد عبود العتيبي",
            "فيصل عيد عساف العتيبي", "ريم مطرود العنزي", "ريما سعد القحطاني", "حسن مطلق خلف السويدي",
            "هديل عبدالله البويريد", "ربى حمزة الزهراني", "فاطمة محمد البارقي", "رقية حمود العديساني",
            "غادة رمضان العنزي", "تماني علي البلوي", "تركي سعد يعقوب العتيبي", "ماجد سعيد عبدالرحمن العتيبي",
            "وليد جمعان مبارك ال حفيان", "علي حسن سراح الشهري", "صافيه ناصر الدوسري", "رفعه مرزوق الدوسري",
            "نوره مسفر القحطاني", "ولاء خالد العمري", "عبدالرحمن طراد حامد الشمري", "عبدالله فهد بداح الدوسري",
            "مطر سميح محمد النفيعي", "علي خيران الشهري", "نواف أحمد محمد كاملي"
        ];

        const namesA3 = [
            "سعد سعود سعد العصيمي", "ناهض مبارك عبدالله الدوسري", "ارجوان زيد أبو ذياب", "سارة راشد العجمي",
            "محمد شاكر مطني الشمري", "نورة محمد البيشي", "تماضر محمد المطيري", "الهنوف محمد الهذيلي",
            "مريم إسماعيل الصيني", "فهد عبدالله عسير المطيري", "حاتم رحيم فارس العتيبي", "ريان دخيل حمود الدخيل",
            "نورة علي القحطاني", "راكان بداح سلطان الشهراني", "نورة محمد معشي", "سميرة أحمد معيني",
            "عائض العتيبيسحر", "بيان عبدالرحمن العمري", "رشا منير العتيبي", "حاتم سليمان المطيري",
            "دخيل عوض دخيل المطيري", "حمود عبدالله حمود الحربي", "حصه مساعد المطيري", "بسمه عليان العتيبي",
            "هاجد عوض هاجد المطيري", "امل حسن علي الشامي", "عائشة مريف العديساني", "سارة إبراهيم الطشلان",
            "ثامر منسي عقيل العنزي"
        ];
        const namesB3 = [
            "محمد سند العتيبي", "عليثه جروان عليثه الروقي", "محمود علي غرمان العمري", "فيصل دخيل القحطاني",
            "شيماء محمد ربيدي", "يزيد مصلح الحربي", "فايز عائض عبدالله الغامدي", "فهد مسفر حسن ال فهاد",
            "مها محمد حمود الجراد", "العزام هند صالح", "غدير ابراهيم العفيصان", "زينب حنيف القرني",
            "حزام حمود محمد العصيمي", "احمد صالح علان الغامدي", "عقاب ناير بدر المطيري", "أمواج سلطان العتيبي",
            "صالحة علي الاسمري", "فوزية حسن الزهراني", "أميرة مبارك الغامدي", "نوره ناصر المبرد",
            "تهاني سعد البيشي", "ابرار مزعل الدهمشي", "أريج جمعان العصيمي", "فاطمة جابر محمد عبدلي",
            "محسن ذيب شليل العتيبي", "تركي مشعان نايض العتيبي", "عبدالرحمن أحمد الغامدي", "يحيى عسران موسى فقيهي"
        ];
        const namesC3 = [
            "محمد سفر عبدالله القحطاني", "مشاري سعود عواض المطيري", "محمد حمود دباشي العلياني",
            "نايف سعد محمد القحطاني", "خالد عبدالله محمد العتيبي", "عبدالعزيز فهد غازي العتيبي", "خلود حارث العمري",
            "شوق ناصر الشهراني", "عايشة جوعان العنزي", "سفره ظافر الشهراني", "محمد ابراهيم عبدالله منيف",
            "عبدالله محمد عبدالله الشمراني", "عبدالعزيز عبدالله الغامدي", "ريم هادي الصيعري", "نورة علي القرني",
            "باشه منصور الدوسري", "مي محمد عبيد", "سلمان عشوي سمر الرويلي", "عبدالله فيحان مضحي العتيبي",
            "رزان سالم القحطاني", "نوف فيصل الشمري", "شاديه حسن احمد", "ريم علي الشهري", "امل عبدالله سهلي",
            "لوله عبدالله الزهراني", "عبدالعزيز حميد باتل الرشيدي", "ماجد عشق بركة العتيبي", "عيسى عزوز محسن الحربي",
            "صالح خلف الرشيدي", "ناصر مذكر ناصر السبيعي"
        ];
        const namesD3 = [
            "سلمان محمد ثويمر المطيري", "أحمد نايف صالح المطيري", "محمد مناحي عبدالله القحطاني", "فهد فلاح مرزوق السبيعي",
            "وليد عواض محمد الحربي", "أحمد سلمان الرشيدي", "فهد محمد العتيبي", "أنجود منور المطيري", "سجى علي الوهيبي",
            "زينب فهد الحربي", "امنية راشد الأحمري", "مشاعل ضاري العنزي", "نبيل أحمد عبده مسرحي", "حمد صالح حمد القحطاني",
            "امنه سعد القحطاني", "ريم فهد الحربي", "حسن محمد حسن أبو طالب", "سلطان ثاقل عايد الشراري", "اصيل عبدالله المطيري",
            "تهاني سعود العتيبي", "نورة سلطان السلطان", "حصه صالح العتيبي", "نهى عيد المطيري", "أبتهال غازي المطيري",
            "خلود خالد العتيبي", "عبدالله الودعاني نايف ناصر", "ناصر شليويح فالح الدوسري", "عبدالعزيز محمد الزهراني",
            "عالي علي الزهراني"
        ];

        const namesA4 = [
            "حسين محمد سعود القحطاني", "عائشة سعد الشهري", "فايز غازي عجب الحربي",
            "ايمان سعيد العلياني", "بلغيث علي محمد البارقي", "نوره عوض الحربي",
            "أثير سعيد الشهراني", "فاطمة عبدالرحمن الشهري", "علياء منير المطيري",
            "فالح مبارك حضرم الدوسري", "عبدالله هادي سابر آل فهاد", "سعيد صالح شاجع العجمي",
            "أفراح نهار العنزي", "خالد عبدالكريم محمد الزهراني", "وداد محمد سويعد المطيري",
            "عائشة خالد المطيري", "جواهر إبراهيم الحميد", "دلال عمر المطيري",
            "علي عايض حسن العمري", "سعد سعيد القرني", "ماجد عبدالعزيز العتيبي",
            "مزنه فائز الاكلبي", "ايمان فهد بن ثنيان", "نوال ناصر الشهراني",
            "ثاري اديهم ثاري الرشيدي", "سلمان محمد احمد الزهراني", "غرام عائض الشمراني",
            "انوار عبدالله الحجيلان", "حنان سعد القحطاني", "خالد عبدالرحمن الشهري"
        ];
        const namesB4 = [
            "سعد عتيوي حبيب الرشيدي", "فهد رابح عويش المطيري", "نايف ناصر عويض العتيبي",
            "عيسى وجدان محمد", "فاتن عبيد الحربي", "هاله علي شعران",
            "سحر سليم العطوي", "أحلام سلطان الحربي", "عبدالمحسن محمد الشراري",
            "مشل سعود مشل التمياط", "عبدالقادر محمد سيد الشهراني", "مشعل مفرح هليل الرشيدي",
            "وداد محمد منور المطيري", "منى فهد العتيبي", "جواهر سفر الغامدي",
            "الهام أحمد الاحمري", "عبير ماجد العوفي", "يوسف زياد يوسف البيشي",
            "ابتسام حميد الحميد", "الهنوف إبراهيم الرميح", "أمل سالم الصيعري",
            "نجوى أحمد الزهراني", "نوف احمد السريحي", "منيرة صالح القنصعي",
            "أمجاد ناجي الدلبحي", "امل موسى العتيبي", "جسار مفرح العتيبي",
            "محمد عواض سارح القرني", "عبدالكريم صالح المطيري", "بدور سعيد الزهراني"
        ];
        const namesC4 = [
            "تركي سعد المطيري", "عبدالعزيز عبيد طامي الحربي", "محمد علي جراد الشهري",
            "عيد محمد عيد القرني", "ظافر عايض سالم العمري", "ممدوح عائض العتيبي",
            "نايف ابراهيم نائف الدوسري", "سميه منصور العتيبي", "محسن مسعود مهدي علي",
            "عبدالله يحي عبدان الزهراني", "عبدالرحمن سند عتيق الشراري", "سلطان وهق علي السهلي",
            "منى محمد الرشيدي", "نوف سعد الرويس", "وعد فهد العنزي", "مسفر مترك مسفر الدوسري",
            "عبدالعزيز أحمد علي الشهراني", "عبدالعزيز طريخم خمخم العنزي", "رندا سالم الحربي",
            "سهام دخيل الحربي", "إيمان مهياء العنزي", "سفره نوار العصيمي", "خلود عبدالله الشهراني",
            "سماهر سعد الصاعدي", "ريم احمد عبدالرحمن", "حلا عبدالله الحويطي",
            "الهنوف محمد الهويمل", "مناحي هتاش منير المرشدي", "فهد مبارك حضرم الدوسري",
            "طلال عايد عيد المطيري", "سعود محمد سعود الحجي"
        ];
        const namesD4 = [
            "عبدالرحمن تركي الشيباني", "رامي شقير المطيري", "محمد تميم مضحي الدوسري",
            "محمد ضاوي المطيري", "سعود عبدالله تركي السبيعي", "غنيه ظافر سهلي",
            "طلال محمد بخيت العتيبي", "شايع عبدالله غانم القحطاني", "سلطان عبدالله نفوع الرشيدي",
            "أريج يحيى معافا", "ابتهال معيض القحطاني", "ريم مطلق البقمي",
            "فاطمة علي الحلافي", "خلود محمد الخثعمي", "مصعب حسن سعيد ال علوان",
            "عبدالله ضحيان هجود الحارثي", "معاذ علي محمد الحبيب", "مطلق فايز مطلق السلولي",
            "عبدالله علي أحمد القرني", "عفاف سعود الزنيتان", "شروق نزال الحربي",
            "نرجس عيسى الدوسري", "مريم عبدالله الزهراني", "بشائر محمد الفيفي",
            "منيفه صويلح العتيبي", "محمد معيوض حمود العتيبي", "صالح محمد الطوب",
            "عيسى حمد جعيبر العنزي", "ناصر مفرح العتيبي", "غادة ناصر ال مرعي"
        ];

        let names;
        switch (department) {
            case 'أ':
                names = room === '2' ? namesA2 : room === '3' ? namesA3 : room === '4' ? namesA4 : [];
                break;
            case 'ب':
                names = room === '2' ? namesB2 : room === '3' ? namesB3 : room === '4' ? namesB4 : [];
                break;
            case 'ج':
                names = room === '2' ? namesC2 : room === '3' ? namesC3 : room === '4' ? namesC4 : [];
                break;
            case 'د':
                names = room === '2' ? namesD2 : room === '3' ? namesD3 : room === '4' ? namesD4 : [];
                break;
            default:
                names = [];
        }

        names.forEach(name => {
            const option = document.createElement("option");
            option.value = name;
            nameList.appendChild(option);
        });
    }

    function updateRank(name) {
        const rankMap = {
            "حسين محمد سعود القحطاني": "وكيل رقيب",
            "عائشة سعد الشهري": "عريف",
            "فايز غازي عجب الحربي": "جندي أول",
            "ايمان سعيد العلياني": "جندي أول",
            "بلغيث علي محمد البارقي": "جندي",
            "نوره عوض الحربي": "جندي",
            "أثير سعيد الشهراني": "جندي",
            "فاطمة عبدالرحمن الشهري": "جندي",
            "علياء منير المطيري": "جندي",
            "فالح مبارك حضرم الدوسري": "وكيل رقيب",
            "عبدالله هادي سابر آل فهاد": "عريف",
            "سعيد صالح شاجع العجمي": "جندي أول",
            "أفراح نهار العنزي": "جندي أول",
            "خالد عبدالكريم محمد الزهراني": "جندي",
            "وداد محمد سويعد المطيري": "جندي",
            "عائشة خالد المطيري": "جندي",
            "جواهر إبراهيم الحميد": "جندي",
            "دلال عمر المطيري": "جندي",
            "علي عايض حسن العمري": "عريف",
            "سعد سعيد القرني": "رقيب أول",
            "ماجد عبدالعزيز العتيبي": "عريف",
            "مزنه فائز الاكلبي": "عريف",
            "ايمان فهد بن ثنيان": "جندي أول",
            "نوال ناصر الشهراني": "جندي أول",
            "ثاري اديهم ثاري الرشيدي": "جندي",
            "سلمان محمد احمد الزهراني": "جندي",
            "غرام عائض الشمراني": "جندي",
            "انوار عبدالله الحجيلان": "جندي",
            "حنان سعد القحطاني": "جندي",
            "خالد عبدالرحمن الشهري": "عريف",
            "سعد عتيوي حبيب الرشيدي": "وكيل رقيب",
            "فهد رابح عويش المطيري": "وكيل رقيب",
            "نايف ناصر عويض العتيبي": "عريف",
            "عيسى وجدان محمد": "عريف",
            "فاتن عبيد الحربي": "عريف",
            "هاله علي شعران": "عريف",
            "سحر سليم العطوي": "عريف",
            "أحلام سلطان الحربي": "عريف",
            "عبدالمحسن محمد الشراري": "جندي أول",
            "مشل سعود مشل التمياط": "جندي أول",
            "عبدالقادر محمد سيد الشهراني": "جندي أول",
            "مشعل مفرح هليل الرشيدي": "جندي أول",
            "وداد محمد منور المطيري": "جندي أول",
            "منى فهد العتيبي": "جندي أول",
            "جواهر سفر الغامدي": "جندي أول",
            "الهام أحمد الاحمري": "جندي أول",
            "عبير ماجد العوفي": "جندي أول",
            "يوسف زياد يوسف البيشي": "جندي",
            "ابتسام حميد الحميد": "جندي",
            "الهنوف إبراهيم الرميح": "جندي",
            "أمل سالم الصيعري": "جندي",
            "نجوى أحمد الزهراني": "جندي",
            "نوف احمد السريحي": "جندي",
            "منيرة صالح القنصعي": "جندي",
            "أمجاد ناجي الدلبحي": "جندي",
            "امل موسى العتيبي": "جندي",
            "جسار مفرح العتيبي": "وكيل رقيب",
            "محمد عواض سارح القرني": "رقيب أول",
            "عبدالكريم صالح المطيري": "عريف",
            "بدور سعيد الزهراني": "عريف",
            "مناحي هتاش منير المرشدي": "وكيل رقيب",
            "تركي سعد المطيري": "رقيب",
            "عيد محمد عيد القرني": "عريف",
            "عبدالله يحي عبدان الزهراني": "جندي أول",
            "عيسى حمد جعيبر العنزي": "رقيب",
            "محمد علي جراد الشهري": "عريف",
            "فهد مبارك حضرم الدوسري": "عريف",
            "عبد الرحمن سند عتيق الشراري": "جندي أول",
            "سلطان وهق علي السهلي": "جندي أول",
            "عبد العزيز طريخم خمخم العنزي": "جندي",
            "سعود محمد سعود الحجي": "وكيل رقيب",
            "ظافر عايض سالم العمري": "عريف",
            "محسن مسعود مهدي علي": "جندي أول",
            "عبد العزيز احمد علي الشهراني": "جندي",
            "مسفر مترك مسفر الدوسري": "جندي",
            "عبد العزيز عبيد طامي الحربي": "وكيل رقيب",
            "ممدوح عائض العتيبي": "عريف",
            "نايف ابراهيم نائف الدوسري": "عريف",
            "سمية منصور العتيبي": "عريف",
            "منى محمد الرشيدي": "جندي أول",
            "نوف سعد الرويس": "جندي أول",
            "وعد فهد العنزي": "جندي",
            "رندا سالم الحربي": "جندي",
            "سهام دخيل الحربي": "جندي",
            "إيمان مهياء العنزي": "جندي",
            "سفره نوار العصيمي": "جندي",
            "خلود عبدالله الشهراني": "جندي",
            "سماهر سعد الصاعدي": "جندي",
            "ريم احمد عبدالرحمن": "جندي",
            "حلا عبدالله الحويطي": "جندي",
            "الهنوف محمد الهويمل": "جندي",
            "طلال عايد عيد المطيري": "رقيب أول",
            "عبدالرحمن تركي الشيباني": "وكيل رقيب",
            "رامي شقير المطيري": "وكيل رقيب",
            "محمد تميم مضحي الدوسري": "عريف",
            "محمد ضاوي المطيري": "عريف",
            "سعود عبدالله تركي السبيعي": "عريف",
            "غنيه ظافر سهلي": "عريف",
            "طلال محمد بخيت العتيبي": "جندي أول",
            "شايع عبدالله غانم القحطاني": "جندي أول",
            "سلطان عبدالله نفوع الرشيدي": "جندي أول",
            "أريج يحيى معافا": "جندي أول",
            "ابتهال معيض القحطاني": "جندي أول",
            "ريم مطلق البقمي": "جندي أول",
            "فاطمة علي الحلافي": "جندي أول",
            "خلود محمد الخثعمي": "جندي",
            "مصعب حسن سعيد ال علوان": "جندي",
            "عبدالله ضحيان هجود الحارثي": "جندي",
            "معاذ علي محمد الحبيب": "جندي",
            "مطلق فايز مطلق السلولي": "جندي",
            "عبدالله علي أحمد القرني": "جندي",
            "عفاف سعود الزنيتان": "جندي",
            "شروق نزال الحربي": "جندي",
            "نرجس عيسى الدوسري": "جندي",
            "مريم عبدالله الزهراني": "جندي",
            "بشائر محمد الفيفي": "جندي",
            "منيفه صويلح العتيبي": "جندي",
            "محمد معيوض حمود العتيبي": "رقيب أول",
            "صالح محمد الطوب": "وكيل رقيب",
            "عيسى حمد جعيبر العنزي": "رقيب",
            "ناصر مفرح العتيبي": "وكيل رقيب",
            "غادة ناصر ال مرعي": "جندي أول"
        };

        const rank = rankMap[name] || "رتبة غير معروفة";
        document.getElementById("rank").value = rank;
    }

    function validateForm() {
        const inputs = document.querySelectorAll('input[required], select[required]');
        const submitButton = document.getElementById('submitButton');
        const errorMessage = document.getElementById('errorMessage');
        const skipValidation = document.getElementById('skipValidation').checked;
        const allFilled = Array.from(inputs).every(input => input.value.trim() !== '');

        submitButton.disabled = !allFilled && !skipValidation;
        errorMessage.style.display = allFilled || skipValidation ? 'none' : 'block';
    }

    function submitForm() {
        const absenceType = document.getElementById('absenceType').value;
        const hijriDate = toArabicNumbers(document.getElementById('hijriDate').value);
        const weekday = document.getElementById('weekday').value;
        const department = document.getElementById('department').value;
        const room = document.getElementById('room').value;
        const name = document.getElementById('name').value;
        const rank = document.getElementById('rank').value;
        const officerName = document.getElementById('officerName').value;
        const officerRank = document.getElementById('officerRank').value;
        const outgoingNumber = document.getElementById('outgoingNumber').value;

        const fullOutgoingNumber = `${outgoingNumber}  / م  ${department} سفر ${room}`;

        const url = `result.html?absenceType=${encodeURIComponent(absenceType)}&hijriDate=${encodeURIComponent(hijriDate)}&weekday=${encodeURIComponent(weekday)}&department=${encodeURIComponent(department)}&room=${encodeURIComponent(room)}&name=${encodeURIComponent(name)}&rank=${encodeURIComponent(rank)}&officerName=${encodeURIComponent(officerName)}&officerRank=${encodeURIComponent(officerRank)}&outgoingNumber=${encodeURIComponent(fullOutgoingNumber)}`;

        window.location.href = url;
    }

    function enableFields() {
        const elements = document.querySelectorAll('input, select');
        elements.forEach(element => {
            element.disabled = false;
        });
        validateForm();
    }

    document.querySelectorAll('input[type="text"]').forEach(input => {
        input.addEventListener('input', function() {
            this.value = toArabicNumbers(this.value);
        });
    });
</script>

</body>
</html>
